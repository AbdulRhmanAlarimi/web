<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="header.css">
    
</head>
<body>
    <!--Header of the page-->
    <div class="container-fluid g1 bg-primary text-white p-2">
        <div class="d-flex align-items-center justify-content-between">
            
            <a href="index.html" class="text-white d-flex align-items-center">
                <img src="img/logo.png" width="50px" alt="Cloud Pharmacy Logo">
                <span class="ms-2 h5">Cloud Pharmacy</span>
            </a>
            
            <ul class="nav y4 k2">
                <li class="nav-item">
                    <a class="nav-link text-white" href="index.html">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="news.html">News</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="funpage.html">Memory Matching Game</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle text-white" href="#" id="pharmacyDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Pharmacies
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="pharmacyDropdown">
                        <li><a class="dropdown-item" href="Pharmacy.html">Pharmacy</a></li>
                        <li><a class="dropdown-item" href="AlHarrasi.html">AlHarrasi</a></li>
                        <li><a class="dropdown-item" href="Alarimi.html">AlAmri</a></li>
                        <li><a class="dropdown-item" href="AlShamsi.html">AlShamsi</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="consultations.php">Consultations</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="Contact us.php">Contact Us</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="Aboutus.php">About Us</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white" href="Feadback.php">Feadback</a>
                </li>
                
                <li class="nav-item">
                    <a class="nav-link text-white" href="calculater.html">carlculater</a>
                </li>
                </ul>
    
            <div class="d-flex align-items-center">
                <a href="login.html" class="text-white me-2">
                    <img src="img/zz-removebg-preview.png" style="width: 40px;">
                </a>
                <a href="sign_up.html" class="text-white">
                    <img src="img/xx-removebg-preview.png" style="width: 30px;">
                </a>
            </div>
        </div>
    </div>
    <!--Title of the page -->
    <div class="container-fluid p-5 bg-primary text-white text-center" style="height: 200px;" >
        <h1>calculater</h1>
    </div>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h2>Pharmacy Drug Selection</h2>
                    </div>
                    <div class="card-body">
                        <!-- Pharmacy Options -->
                        <div class="mb-3">
                            <h4>Choose Pharmacy:</h4>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="pharmacy" id="Alarimi" value="Alarimi">
                                <label class="form-check-label" for="Alarimi">
                                    Alarimi Pharmacy
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="pharmacy" id="AlHarrasi" value="AlHarrasi">
                                <label class="form-check-label" for="AlHarrasi">
                                    AlHarrasi Pharmacy <span style="color: red;">%20 offers</span>
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="pharmacy" id="AlShamsi" value="AlShamsi">
                                <label class="form-check-label" for="AlShamsi">
                                    AlShamsi Pharmacy
                                </label>
                            </div>
                        </div>

                        <!-- Display Drugs items after select the pharmacy -->
                        <div id="drugsContainer" style="display:none;">
                            <h4>Select Drugs:</h4>
                            <div id="drugsList"></div>
                        </div>

                        <!-- Generate Bill button to display the bill after onclick-->
                        <button id="generateBillBtn" class="btn btn-primary mt-3" style="display:none;">
                            Generate Bill
                        </button>

                        <!-- Display Bill -->
                        <div id="billDetails" class="mt-3" style="display:none;">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">Bill Details</h5>
                                    <div id="billContent"></div>
                                    <div id="totalBill" class="fw-bold mt-2"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
    // Pharmacise information each on has dictionary list with drug name & price inside list
    var pharmacyData = {
        'Alarimi': [
            { name: 'Calcium Citrate Petites', price: 7 },
            { name: 'Vitamin C 500 mg Softgels', price: 4.9 },
            { name: 'VapoRub', price: 5 },
            { name: 'Adol 500 mg', price: 0.50 }
        ],
        'AlHarrasi': [
            { name: 'Extra Strength Sore Throat', price: 3.2 },
            { name: 'Headache Relief Caplets Extra Strength', price: 1.6 },
            { name: 'Head-To-Toe Gentle Tear-Free Baby Wash & Shampoo', price: 4 },
            { name: 'Levothyroxine', price: 4.75 }
        ],
        'AlShamsi': [
            { name: 'Prosobee Soy-Based Infant Formula For Sensitive', price: 12 },
            { name: 'PediaSure Complete Chocolate With TripleSure System', price: 6 },
            { name: 'Melt-In Milk Face and Body Sunscreen Lotion SPF 60', price: 8 },
            { name: 'Deodorant With Natural Deodorizers Fresh + (1 free)', price: 4.20 }
        ]
    };

    // initialize the variables from the html documment
    var pharmacyType = document.getElementsByName('pharmacy');
    var drugsCard = document.getElementById('drugsContainer');
    var drugsItems = document.getElementById('drugsList');
    var generateBillBtn = document.getElementById('generateBillBtn');
    var billDetails = document.getElementById('billDetails');
    var billContent = document.getElementById('billContent');
    var totalBill = document.getElementById('totalBill');

    // Add event listeners to pharmacy radios
    for (var i = 0; i < pharmacyType.length; i++) {
        pharmacyType[i].addEventListener('change', function() {
            if (this.checked) {
                //call showDrugs function
                showDrugs(this.value);
            }
        });
    }

    // display drugs of that pharmacy selected
    function showDrugs(pharmacy) {
        // remove drugs & bill before display new drugs 
        drugsItems.innerHTML = '';
        drugsCard.style.display = 'block';
        generateBillBtn.style.display = 'none';
        billDetails.style.display = 'none';

        // get the drugs with name & price in that pharmacy
        var drugs = pharmacyData[pharmacy];

        // Create 4 checkboxes for drugs
        for (var j = 0; j < 4; j++) {
            // get the drugs 
            var drug = drugs[j];
            // fixe the html documment by creat a div for checkboxe
            var drugDiv = document.createElement('div');
            drugDiv.className = 'form-check';
            
            // initialize check box with data (type,classNameBootstrap,id,value)
            var checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.className = 'form-check-input drug-checkbox';
            checkbox.id = drug.name;
            checkbox.value = drug.name;
            
            // initialize label with info 
            var label = document.createElement('label');
            label.className = 'form-check-label';
            label.htmlFor = drug.name;
            label.textContent = drug.name + ' - ' + drug.price.toFixed(2) + ' R.O';
            
            //add the boxes and label to div of drug then add div of drug to drugItem to display it in html
            drugDiv.appendChild(checkbox);
            drugDiv.appendChild(label);
            drugsItems.appendChild(drugDiv);

            // Add change event to show/hide generate bill button
            checkbox.addEventListener('change', function() {
                var checkedDrugs = document.querySelectorAll('.drug-checkbox:checked');
                generateBillBtn.style.display = checkedDrugs.length > 0 ? 'block' : 'none';
            });
        }
    }

    // Generate Bill when click on button
    generateBillBtn.addEventListener('click', function() {
        var selectedPharmacy = document.querySelector('input[name="pharmacy"]:checked').value;
        var selectedDrugs = document.querySelectorAll('.drug-checkbox:checked');
    
        // Clear bill
        billContent.innerHTML = '';
    
        //initialize total
        var total = 0;
    
        // Pharmacy name dispaly
        var pharmacyName = document.createElement('p');
        pharmacyName.innerHTML = '<strong>Pharmacy:</strong> ' + selectedPharmacy;
        billContent.appendChild(pharmacyName);

        // Add selected drugs to bill
        for (var k = 0; k < selectedDrugs.length; k++) {
            var drug = selectedDrugs[k];
            var drugData = pharmacyData[selectedPharmacy].find(function(d) {
                return d.name === drug.value;
            });
        
            //creat a div for drug in bill display
            var drugRow = document.createElement('div');
            drugRow.className = 'd-flex justify-content-between';
            drugRow.innerHTML = '<span>' + drugData.name + '</span><span>' + drugData.price.toFixed(2) + 'R.O</span>';
        
            //add the drug to bil contant
            billContent.appendChild(drugRow);
            //count the total
            total += drugData.price;

        }
        
        // apply the dicount 20% for AlHarrasi pharmacy
        if (selectedPharmacy === 'AlHarrasi'){
            total = total*0.8
        }

        // Display the total price
        totalBill.textContent = 'Total: ' + total.toFixed(2)+' R.O';
    
        // Display the bill
        billDetails.style.display = 'block';
    });

    
    </script>
</body>
</html>
